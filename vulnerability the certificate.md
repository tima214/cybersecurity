# cybersecurity
-im import cybersecurity

param (
    [string]$CertPath
)

if (-not (Test-Path $CertPath)) {
    Write-Host "‚ùå –£–∫–∞–∂–∏—Ç–µ –ø—É—Ç—å –∫ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—É –≤ —Ñ–æ—Ä–º–∞—Ç–µ PEM (.pem –∏–ª–∏ .crt)"
    exit 1
}

Write-Host "`nüîç –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞: $CertPath"
Write-Host "-----------------------------"

# 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ä–æ–∫–∞ –¥–µ–π—Å—Ç–≤–∏—è
$dates = & openssl x509 -in $CertPath -noout -dates
Write-Host "`n‚è≥ –î–∞—Ç—ã –¥–µ–π—Å—Ç–≤–∏—è:"
$dates

# 2. –ê–ª–≥–æ—Ä–∏—Ç–º –ø–æ–¥–ø–∏—Å–∏
$algoLine = & openssl x509 -in $CertPath -noout -text | Select-String "Signature Algorithm" | Select-Object -First 1
Write-Host "`nüîè –ê–ª–≥–æ—Ä–∏—Ç–º –ø–æ–¥–ø–∏—Å–∏: $($algoLine.Line)"
if ($algoLine.Line -match "sha1") {
    Write-Host "‚ö†Ô∏è –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è SHA1 ‚Äî —É—è–∑–≤–∏–º—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º!" -ForegroundColor Yellow
}

# 3. –†–∞–∑–º–µ—Ä –æ—Ç–∫—Ä—ã—Ç–æ–≥–æ –∫–ª—é—á–∞
$keyLine = & openssl x509 -in $CertPath -noout -text | Select-String "Public-Key"
$keyBits = ($keyLine.Line -replace '\D','') # –æ—Å—Ç–∞–≤–∏—Ç—å —Ç–æ–ª—å–∫–æ —Ü–∏—Ñ—Ä—ã
Write-Host "`nüîê –†–∞–∑–º–µ—Ä –∫–ª—é—á–∞: $keyBits –±–∏—Ç"
if ([int]$keyBits -lt 2048) {
    Write-Host "‚ö†Ô∏è –ö–ª—é—á —Å–ª–∏—à–∫–æ–º –∫–æ—Ä–æ—Ç–∫–∏–π!" -ForegroundColor Yellow
}

# 4. –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Å–∞–º–æ–ø–æ–¥–ø–∏—Å–∞–Ω–Ω–æ—Å—Ç—å
$subject = & openssl x509 -in $CertPath -noout -subject
$issuer  = & openssl x509 -in $CertPath -noout -issuer

Write-Host "`nüìå Subject: $subject"
Write-Host "üìå Issuer: $issuer"

if ($subject -eq $issuer) {
    Write-Host "‚ö†Ô∏è –°–∞–º–æ–ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–π —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç!" -ForegroundColor Yellow
}

Write-Host "`n‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞."

 and vulnerability the certificate 1 code on github 
